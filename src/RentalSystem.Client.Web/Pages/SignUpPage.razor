@page "/signUp"
@using RentalSystem.Shared.DTOs
@layout EmptyLayout
@inject IJSRuntime JS

<PageTitle>Zarejestruj się</PageTitle>

<div style="width: 100%; height: 100vh; display: flex; padding: 0px">
    <RadzenColumn Style="width: 60%; background-color: rgba(45, 62, 80, 100); display: flex; font-size: 30px; padding: 0px">
        <RadzenText Text="RentAThing" Style="margin: auto; width: 200px; text-align: center; color: rgb(255,255,255)" />
    </RadzenColumn>

    <RadzenColumn Style="width: 40%; display: flex; background-color: rgba(241,242,246,100); padding: 0px">
        <RadzenColumn Style="text-align: center; display: grid; width: 250px; margin: auto">
            <RadzenText Text="Email" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenTextBox Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="userRequest.Email"></RadzenTextBox>

            <RadzenText Text="Imię" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenTextBox Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="userRequest.Name"></RadzenTextBox>

            <RadzenText Text="Nazwisko" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenTextBox Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="userRequest.Surname"></RadzenTextBox>

            <RadzenText Text="Hasło" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenPassword Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="password"></RadzenPassword>

            <RadzenText Text="Powtórz hasło" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenPassword Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="repetedPassword"></RadzenPassword>

            <RadzenText Text="Numer telefonu" Style="margin: auto; width: 200px; text-align: left" />
            <RadzenTextBox Style="margin: auto; margin-top: 5px; margin-bottom: 10px; width: 200px" @bind-Value="userRequest.PhoneNumber"></RadzenTextBox>

            <RadzenButton Text="Zarejestruj się" Click="@SignUp" Style="width: 150px; display: flex; margin: auto; height: 30px; margin-top: 10px; font-style: normal; text-align: center"></RadzenButton>
        </RadzenColumn>
    </RadzenColumn>
</div>




@* <RadzenTemplateForm Data="@model" Submit="@Register">
    <RadzenTextBox @bind-Value="model.Email" Placeholder="Email" />
    <RadzenPassword @bind-Value="model.Password" Placeholder="Password" />
    <RadzenButton Text="Register" ButtonType="Submit" />
</RadzenTemplateForm> *@


@code {
    private CreateUserRequest userRequest = new();
    private string password;
    private string repetedPassword;

    async Task SignUp()
    {
        try
        {
            var jsDefined = await JS.InvokeAsync<bool>("eval", "typeof window.firebaseAuth !== 'undefined'");
            if (!jsDefined)
            {
                Console.WriteLine("firebaseAuth not loaded yet!");
                return;
            }

            var token = await JS.InvokeAsync<string>("firebaseAuth.register", userRequest.Email, password);
            Console.WriteLine("Firebase ID Token: " + token);
        }
        catch (JSException jsEx)
        {
            Console.WriteLine("JS Error: " + jsEx.Message);
        }
        catch (Exception ex)
        {
            Console.WriteLine("Other Error: " + ex.Message);
        }
    }
}

